!-----------------------------------------------------------------------------
! (c) The copyright relating to this work is owned jointly by the Crown, 
! Met Office and NERC 2014. 
! However, it has been created with the help of the GungHo Consortium, 
! whose members are identified at https://puma.nerc.ac.uk/trac/GungHo/wiki
!-----------------------------------------------------------------------------

!> Test the mesh module
!>
module constants_mod_test
  use, intrinsic :: iso_fortran_env
  use pFUnit_Mod

  implicit none 

contains

  !> test to ensure that real type real32 is 32 bits
  !>
  @test
  subroutine test_constants_real32( )
    implicit none

    real (kind=real32) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 32)

  end subroutine test_constants_real32

  !> test to ensure that real type real64 is 64 bits
  !>
  @test
  subroutine test_constants_real64( )
    implicit none

    real (kind=real64) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 64)

  end subroutine test_constants_real64

  !> test to ensure that real type real128 is 128 bits
  !>
  @test
  subroutine test_constants_real128( )
    implicit none

    real (kind=real128) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 128)

  end subroutine test_constants_real128

  !> test to ensure that real type r_native is the same kind as a default real
  !>
  @test
  subroutine test_constants_r_native( )
    use constants_mod, only : r_native
    implicit none

    real (kind=r_native) :: val_native
    real                 :: val_default
    
    @assertEqual(kind(val_native), kind(val_default))

  end subroutine test_constants_r_native

  !> test to ensure that real type int8 is 8 bits
  !>
  @test
  subroutine test_constants_int8( )
    implicit none

    integer (kind=int8) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 8)

  end subroutine test_constants_int8

  !> test to ensure that real type int16 is 16 bits
  !>
  @test
  subroutine test_constants_int16( )
    implicit none

    integer (kind=int16) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 16)

  end subroutine test_constants_int16

  !> test to ensure that real type int32 is 32 bits
  !>
  @test
  subroutine test_constants_int32( )
    implicit none

    integer (kind=int32) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 32)

  end subroutine test_constants_int32

  !> test to ensure that real type int64 is 64 bits
  !>
  @test
  subroutine test_constants_int64( )
    implicit none

    integer (kind=int64) :: val
    
    !> Need to cast the return value of storage_size to int to get around a problem 
    !> in the gfortran compiler version 3.9 which does not return a default integer 

    @assertEqual(int(storage_size(val)), 64)

  end subroutine test_constants_int64

  !> test to ensure that integer type i_native is the same kind as a default integer
  !>
  @test
  subroutine test_constants_i_native( )
    use constants_mod, only : i_native
    implicit none

    integer (kind=i_native) :: val_native
    integer                 :: val_default
    
    @assertEqual(kind(val_native), kind(val_default))

  end subroutine test_constants_i_native

  !> test to ensure that logical type l_native is the same kind as a default logical
  !>
  @test
  subroutine test_constants_l_native( )
    use constants_mod, only : l_native
    implicit none

    logical (kind=l_native) :: val_native
    logical                 :: val_default
    
    @assertEqual(kind(val_native), kind(val_default))

  end subroutine test_constants_l_native

  !> test to ensure that character type c_native is the same kind as a default character
  !>
  @test
  subroutine test_constants_c_native( )
    use constants_mod, only : c_native
    implicit none

    character (kind=c_native) :: val_native
    character                 :: val_default
    
    @assertEqual(kind(val_native), kind(val_default))

  end subroutine test_constants_c_native

end module constants_mod_test
