!-------------------------------------------------------------------------------
! (c) The copyright relating to this work is owned jointly by the Crown, 
! Met Office and NERC 2014. 
! However, it has been created with the help of the GungHo Consortium, 
! whose members are identified at https://puma.nerc.ac.uk/trac/GungHo/wiki
!-------------------------------------------------------------------------------
!
!-------------------------------------------------------------------------------
module v3_solver_kernel_modTest
  implicit none 

contains

  @test
  subroutine v3_solver_kernel_test()
    use pFUnit_Mod
    use v3_solver_kernel_mod, only : solver_v3_code
    use constants_mod,        only : dp
    use gaussian_quadrature_mod,  only : gaussian_quadrature_type
    implicit none

    integer :: num_layers, ndf, map(1)
    type(gaussian_quadrature_type) :: gq
    real(kind=dp) :: xdata(1)
    real(kind=dp) :: rhsdata(1)
    real(kind=dp) :: answer, tol
    real(kind=dp) :: basis(3,3,3,3,1)
    
    basis=1.0D0
    gq=gaussian_quadrature_type()
    map(1)=1
    num_layers=1
    ndf=1
    rhsdata(1)=1.0D0
    call solver_v3_code(num_layers,ndf,map,basis,xdata,rhsdata,gq)
    
    write(*,*) "v3_solver_kernel test"
    answer = 1.0D0
    tol=1.0e-14
    write(*,*) "v3_solver_kernel xdata, answer"
    write(*,*) xdata(1),answer
    @assertEqual(xdata(1),answer,tol)
    
    write(*,*) "--------------------------------"

  end subroutine v3_solver_kernel_test
  
end module v3_solver_kernel_modTest
